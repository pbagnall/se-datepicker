<!doctype html>
<html lang="en/GB">
<head>
   <title>Date Picker demo</title>
   <script src="/lib/dayjs.js"></script>
   <script type='module' src='/components/datepicker.js'></script>
   <link rel='stylesheet' href='/styles.css' />
   <link rel='stylesheet' href='/demostyles.css' />
   <script type='text/javascript'>
      function dateChanged(event) {
         const output = document.getElementById('output');
         const date = dayjs(event.value);
         output.replaceChildren(document.createTextNode(date.format("DD-MMM-YYYY")));
      }

      function popupTriggered() {
         const trigger = document.getElementById("trigger");
         if (trigger.textContent === 'Open popup') {
            document.getElementById("popup").open();
            trigger.textContent = 'Close popup'
         } else {
            document.getElementById("popup").close();
         }
      }

      function popupClosed() {
         const trigger = document.getElementById("trigger");
         trigger.textContent = 'Open popup';
      }
   </script>
</head>
<body>
   <h1>Date picker web component</h1>
   <nav>
      <ul>
         <li class='selected'><a href='/'>Overview</a></li>
         <li><a href='/docs.html'>Documentation</a></li>
      </ul>
   </nav>

   <section>
      <p>
      <se-datepicker date='today' onchange='dateChanged(event)'></se-datepicker>
      Selected date = <output id='output'>12-May-2023</output>
      </p>

      <se-datepicker class='topright alternate'></se-datepicker>
      <se-datepicker class='bottomright' date='2023-1-12'></se-datepicker>

      <button id='trigger' onclick='popupTriggered()'>Open popup</button>
      <se-popup id='popup' anchor='trigger' anchor-direction='se,em,en' onclose='popupClosed()'>
         This is a popup. It has a bunch of content in it. And then some more, and some more.
      </se-popup>
   </section>
   <section>
      <details>
         <summary>Features</summary>
         <ul>
            <li>Multiple month display - time is a continuum!</li>
            <li>Infinitely Scrollable calendar</li>
            <li>Styleable using CSS custom variables</li>
            <li>Can be fully controlled by keyboard</li>
         </ul>
      </details>
      <details open>
         <summary>To Do</summary>
         <ul>
            <li>
               Fix focus issues. When you click on background or a button, keyboard focus is lost
            </li>
            <li>
               When you go down a month (either by keyboard or quick button) it should preserve the scroll offset
               of the current selection, assuming it's in view. If not it should jump it into view, rather than
               having the selection center itself.
            </li>
            <li>
               Look at performance of jumping a year - at the moment it can't keep up with keyboard auto-repeat, which
               is a bit of a nuisance (causing overshoots when you keep pageup/down held down). This might be as simple
               as reducing the number rows maintained.
            </li>
            <li>
               Fix popup bug, where it's appearing in "em" position, even though it's
               too close to the bottom.
            </li>
            <li>Implement date parsing for typed input</li>
            <li>Implement canned dates options</li>
            <li>Add a decent icon for the input field</li>
            <li>Add decent icons for month/year up/down buttons</li>
            <li>
               Make the number of rows in the table dynamic, and relate to the size of the dialog, rather than just a fixed number
            </li>
         </ul>
      </details>

      <details>
         <summary>Future ideas</summary>
         <ul>
            <li>Add API for adding "busy" indicators to calendar</li>
            <li>
               If today and selected date are close together, then when the picker opens
               it should scroll so both are visible
            </li>
            <li>
               Extend into DateRangePicker - can register for both se-datepicker and
               se-datarangepicker
            </li>
            <li>
               Options:
               <ul>
                  <li>Exclude weekend (default: false), from usecase</li>
                  <li>
                     Weeks starts on Monday/Sunday (default: Monday), maybe from locale, maybe
                     user prefs
                  </li>
                  <li>Date format in input field (default: DD MMM YYYY), from locale</li>
               </ul>
            </li>
            <li>
               CSS styles: (as custom variables)
               <ul>
                  <li>Calendar Layout: D M Y or M D Y or Y M D (default: D M Y)</li>
               </ul>
            </li>
            <li>
               Accessible version should be designed to be ultra terse to give rapid equivalent
               experience
            </li>
         </ul>
      </details>
   </section>
</body>
</html>
